<?php

namespace App\Exports\juntos\kids;

use Illuminate\Contracts\View\View;
use Illuminate\Support\Facades\DB;
use Maatwebsite\Excel\Concerns\FromView;
use Maatwebsite\Excel\Concerns\ShouldAutoSize;

class CredPaqueteExport implements FromView, ShouldAutoSize
{
    protected $red;
    protected $dist;
    protected $anio;
    protected $type;

    public function __construct($red, $dist, $anio, $type)
    {
        $this->red=$red;
        $this->dist=$dist;
        $this->anio=$anio;
        $this->type=$type;
    }

    public function view(): View {

        $red = $this->red;
        $dist = $this->dist;
        $anio = $this->anio;
        $type = $this->type;

        if($type == 'conteo'){
            if($red == 'TODOS'){
                if($anio == 'TODOS'){
                    $anio = 'Todos';
                    $resCredMes = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', DB::raw("COUNT(DISTRITO_RES) DENOMINADOR"), DB::raw("SUM(CASE
                                    WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL  THEN 1
                                    WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                    WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                    ELSE 0 END) 'NUM_HIS'"),
                                //  DB::raw("round((cast(SUM(CASE WHEN (_CRED_12_mes IS NOT NULL AND
                                //  _CRED_14_mes IS NOT NULL AND _CRED_16_mes IS NOT NULL AND _CRED_18_mes IS NOT NULL AND _CRED_20_mes IS NOT NULL AND _CRED_22_mes IS NOT NULL)
                                //  THEN 1 ELSE 0 END) as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_JUNT'"), 
                                    DB::raw("SUM(CASE
                                    WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                    WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                    WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                    ELSE 0 END) 'NUM_JUNTOS'"))
                                    // DB::raw("round((cast(SUM(CASE WHEN ([12CTRL] IS NOT NULL AND
                                    // [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL) THEN 1 ELSE 0 END)
                                    // as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_HIS'"))
                                ->groupBy('PROVINCIA_RES') ->groupBy('DISTRITO_RES') ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();

                }else{
                    $resCredMes = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', DB::raw("COUNT(DISTRITO_RES) DENOMINADOR"), DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_HIS'"),
                            //  DB::raw("round((cast(SUM(CASE WHEN (_CRED_12_mes IS NOT NULL AND
                            //  _CRED_14_mes IS NOT NULL AND _CRED_16_mes IS NOT NULL AND _CRED_18_mes IS NOT NULL AND _CRED_20_mes IS NOT NULL AND _CRED_22_mes IS NOT NULL)
                            //  THEN 1 ELSE 0 END) as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_JUNT'"), 
                                DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_JUNTOS'"))
                                ->groupBy('PROVINCIA_RES') ->groupBy('DISTRITO_RES') ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();
                }
            }
            else if($red != 'TODOS' && $dist == 'TODOS'){
                if($anio == 'TODOS'){
                    $anio = 'Todos';
                    $resCredMes = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', DB::raw("COUNT(DISTRITO_RES) DENOMINADOR"), DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_HIS'"),
                            //  DB::raw("round((cast(SUM(CASE WHEN (_CRED_12_mes IS NOT NULL AND
                            //  _CRED_14_mes IS NOT NULL AND _CRED_16_mes IS NOT NULL AND _CRED_18_mes IS NOT NULL AND _CRED_20_mes IS NOT NULL AND _CRED_22_mes IS NOT NULL)
                            //  THEN 1 ELSE 0 END) as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_JUNT'"), 
                                DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_JUNTOS'"))
                                ->groupBy('PROVINCIA_RES') ->groupBy('DISTRITO_RES') ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();

                }else{
                    $resCredMes = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', DB::raw("COUNT(DISTRITO_RES) DENOMINADOR"), DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_HIS'"),
                            //  DB::raw("round((cast(SUM(CASE WHEN (_CRED_12_mes IS NOT NULL AND
                            //  _CRED_14_mes IS NOT NULL AND _CRED_16_mes IS NOT NULL AND _CRED_18_mes IS NOT NULL AND _CRED_20_mes IS NOT NULL AND _CRED_22_mes IS NOT NULL)
                            //  THEN 1 ELSE 0 END) as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_JUNT'"), 
                                DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_JUNTOS'"))
                                ->groupBy('PROVINCIA_RES') ->groupBy('DISTRITO_RES') ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();
                }
            }
            else if($dist != 'TODOS'){
                if($anio == 'TODOS'){
                    $anio = 'Todos';
                    $resCredMes = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', DB::raw("COUNT(DISTRITO_RES) DENOMINADOR"), DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_HIS'"),
                            //  DB::raw("round((cast(SUM(CASE WHEN (_CRED_12_mes IS NOT NULL AND
                            //  _CRED_14_mes IS NOT NULL AND _CRED_16_mes IS NOT NULL AND _CRED_18_mes IS NOT NULL AND _CRED_20_mes IS NOT NULL AND _CRED_22_mes IS NOT NULL)
                            //  THEN 1 ELSE 0 END) as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_JUNT'"), 
                                DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_JUNTOS'"))
                                ->groupBy('PROVINCIA_RES') ->groupBy('DISTRITO_RES') ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();

                }else{
                    $resCredMes = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', DB::raw("COUNT(DISTRITO_RES) DENOMINADOR"), DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_HIS'"),
                //  DB::raw("round((cast(SUM(CASE WHEN (_CRED_12_mes IS NOT NULL AND
                //  _CRED_14_mes IS NOT NULL AND _CRED_16_mes IS NOT NULL AND _CRED_18_mes IS NOT NULL AND _CRED_20_mes IS NOT NULL AND _CRED_22_mes IS NOT NULL)
                //  THEN 1 ELSE 0 END) as float) / cast(COUNT(DISTRITO_RES) as float) * 100), 2) 'AVANCE_JUNT'"), 
                                DB::raw("SUM(CASE
                                WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END) 'NUM_JUNTOS'"))
                                ->groupBy('PROVINCIA_RES') ->groupBy('DISTRITO_RES') ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();
                }
            }

            return view('juntos.kids.credpaquete.printConteo', [ 'nominal' => $resCredMes, 'anio' => $anio ]);
        }
        else if($type == 'nominal'){
            if($red == 'TODOS'){
                if($anio == 'TODOS'){
                    $anio = 'Todos';
                    $nominalCred = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                                ->select('PROVINCIA_RES', 'DISTRITO_RES', 'DNI_MO', 'FECHA_DE_NAC_MO', 'EDADMESES', '1CTRL RN as CTRLRN1', '2CTRL RN as CTRLRN2', '3CTRL RN as CTRLRN3', '4CTRL RN as CTRLRN4', '1CTRL as CTRL1', '2CTRL as CTRL2', '3CTRL as CTRL3', '4CTRL as CTRL4', '5CTRL as CTRL5', '6CTRL as CTRL6',
                                '7CTRL as CTRL7', '8CTRL as CTRL8', '9CTRL as CTRL9', '10CTRL as CTRL10', '11CTRL as CTRL11', '12CTRL as CTRL12', '14CTRL as CTRL14', '16CTRL as CTRL16', '18CTRL as CTRL18', '20CTRL as CTRL20', '22CTRL as CTRL22',
                                DB::raw("CASE WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0
                                END 'AVANCE_HIS'"),
                                'CRN1', 'CRN2', '_CRED_1_mes', '_CRED_2_mes', '_CRED_3_mes', '_CRED_4_mes', '_CRED_5_mes', '_CRED_6_mes', '_CRED_7_mes', '_CRED_8_mes', '_CRED_9_mes', '_CRED_10_mes', '_CRED_11_mes',
                                '_CRED_12_mes', '_CRED_14_mes', '_CRED_16_mes', '_CRED_18_mes', '_CRED_20_mes', '_CRED_22_mes',
                                DB::raw("CASE WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END 'AVANCE_JUNTOS'"))
                                ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();
                }
                else{
                    $nominalCred = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                    ->select('PROVINCIA_RES', 'DISTRITO_RES', 'DNI_MO', 'FECHA_DE_NAC_MO', 'EDADMESES', '1CTRL RN as CTRLRN1', '2CTRL RN as CTRLRN2', '3CTRL RN as CTRLRN3', '4CTRL RN as CTRLRN4', '1CTRL as CTRL1', '2CTRL as CTRL2', '3CTRL as CTRL3', '4CTRL as CTRL4', '5CTRL as CTRL5', '6CTRL as CTRL6',
                    '7CTRL as CTRL7', '8CTRL as CTRL8', '9CTRL as CTRL9', '10CTRL as CTRL10', '11CTRL as CTRL11', '12CTRL as CTRL12', '14CTRL as CTRL14', '16CTRL as CTRL16', '18CTRL as CTRL18', '20CTRL as CTRL20', '22CTRL as CTRL22',
                                DB::raw("CASE WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0
                                END 'AVANCE_HIS'"),
                                'CRN1', 'CRN2', '_CRED_1_mes', '_CRED_2_mes', '_CRED_3_mes', '_CRED_4_mes', '_CRED_5_mes', '_CRED_6_mes', '_CRED_7_mes', '_CRED_8_mes', '_CRED_9_mes', '_CRED_10_mes', '_CRED_11_mes',
                                '_CRED_12_mes', '_CRED_14_mes', '_CRED_16_mes', '_CRED_18_mes', '_CRED_20_mes', '_CRED_22_mes',
                                DB::raw("CASE WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END 'AVANCE_JUNTOS'"))
                                ->whereYear('FECHA_DE_NAC_MO', $anio) ->orderBy('PROVINCIA_RES') ->orderBy('DISTRITO_RES') ->get();
                }
            }
            else if($red != 'TODOS' && $dist == 'TODOS'){
                if($anio == 'TODOS'){
                    $anio = 'Todos';
                    $nominalCred = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                    ->select('PROVINCIA_RES', 'DISTRITO_RES', 'DNI_MO', 'FECHA_DE_NAC_MO', 'EDADMESES', '1CTRL RN as CTRLRN1', '2CTRL RN as CTRLRN2', '3CTRL RN as CTRLRN3', '4CTRL RN as CTRLRN4', '1CTRL as CTRL1', '2CTRL as CTRL2', '3CTRL as CTRL3', '4CTRL as CTRL4', '5CTRL as CTRL5', '6CTRL as CTRL6',
                    '7CTRL as CTRL7', '8CTRL as CTRL8', '9CTRL as CTRL9', '10CTRL as CTRL10', '11CTRL as CTRL11', '12CTRL as CTRL12', '14CTRL as CTRL14', '16CTRL as CTRL16', '18CTRL as CTRL18', '20CTRL as CTRL20', '22CTRL as CTRL22',
                                DB::raw("CASE WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0
                                END 'AVANCE_HIS'"),
                                'CRN1', 'CRN2', '_CRED_1_mes', '_CRED_2_mes', '_CRED_3_mes', '_CRED_4_mes', '_CRED_5_mes', '_CRED_6_mes', '_CRED_7_mes', '_CRED_8_mes', '_CRED_9_mes', '_CRED_10_mes', '_CRED_11_mes',
                                '_CRED_12_mes', '_CRED_14_mes', '_CRED_16_mes', '_CRED_18_mes', '_CRED_20_mes', '_CRED_22_mes',
                                DB::raw("CASE WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END 'AVANCE_JUNTOS'"))
                                ->where('PROVINCIA_RES', $red) ->orderBy('DISTRITO_RES') ->get();
                }
                else{
                    $nominalCred = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                    ->select('PROVINCIA_RES', 'DISTRITO_RES', 'DNI_MO', 'FECHA_DE_NAC_MO', 'EDADMESES', '1CTRL RN as CTRLRN1', '2CTRL RN as CTRLRN2', '3CTRL RN as CTRLRN3', '4CTRL RN as CTRLRN4', '1CTRL as CTRL1', '2CTRL as CTRL2', '3CTRL as CTRL3', '4CTRL as CTRL4', '5CTRL as CTRL5', '6CTRL as CTRL6',
                    '7CTRL as CTRL7', '8CTRL as CTRL8', '9CTRL as CTRL9', '10CTRL as CTRL10', '11CTRL as CTRL11', '12CTRL as CTRL12', '14CTRL as CTRL14', '16CTRL as CTRL16', '18CTRL as CTRL18', '20CTRL as CTRL20', '22CTRL as CTRL22',
                                DB::raw("CASE WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0
                                END 'AVANCE_HIS'"),
                                'CRN1', 'CRN2', '_CRED_1_mes', '_CRED_2_mes', '_CRED_3_mes', '_CRED_4_mes', '_CRED_5_mes', '_CRED_6_mes', '_CRED_7_mes', '_CRED_8_mes', '_CRED_9_mes', '_CRED_10_mes', '_CRED_11_mes',
                                '_CRED_12_mes', '_CRED_14_mes', '_CRED_16_mes', '_CRED_18_mes', '_CRED_20_mes', '_CRED_22_mes',
                                DB::raw("CASE WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END 'AVANCE_JUNTOS'"))
                                ->where('PROVINCIA_RES', $red) ->whereYear('FECHA_DE_NAC_MO', $anio) ->orderBy('DISTRITO_RES') ->get();
                }
            }
            else if($dist != 'TODOS'){
                if($anio == 'TODOS'){
                    $anio = 'Todos';
                    $nominalCred = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                    ->select('PROVINCIA_RES', 'DISTRITO_RES', 'DNI_MO', 'FECHA_DE_NAC_MO', 'EDADMESES', '1CTRL RN as CTRLRN1', '2CTRL RN as CTRLRN2', '3CTRL RN as CTRLRN3', '4CTRL RN as CTRLRN4', '1CTRL as CTRL1', '2CTRL as CTRL2', '3CTRL as CTRL3', '4CTRL as CTRL4', '5CTRL as CTRL5', '6CTRL as CTRL6',
                    '7CTRL as CTRL7', '8CTRL as CTRL8', '9CTRL as CTRL9', '10CTRL as CTRL10', '11CTRL as CTRL11', '12CTRL as CTRL12', '14CTRL as CTRL14', '16CTRL as CTRL16', '18CTRL as CTRL18', '20CTRL as CTRL20', '22CTRL as CTRL22',
                                DB::raw("CASE WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0
                                END 'AVANCE_HIS'"),
                                'CRN1', 'CRN2', '_CRED_1_mes', '_CRED_2_mes', '_CRED_3_mes', '_CRED_4_mes', '_CRED_5_mes', '_CRED_6_mes', '_CRED_7_mes', '_CRED_8_mes', '_CRED_9_mes', '_CRED_10_mes', '_CRED_11_mes',
                                '_CRED_12_mes', '_CRED_14_mes', '_CRED_16_mes', '_CRED_18_mes', '_CRED_20_mes', '_CRED_22_mes',
                                DB::raw("CASE WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END 'AVANCE_JUNTOS'"))
                                ->where('DISTRITO_RES', $dist) ->orderBy('DISTRITO_RES') ->get();
                }
                else{
                    $nominalCred = DB::connection('BD_JUNTOS') ->table('dbo.CONSOLIDADO_NINO_PAQUETE_JUNTOS')
                    ->select('PROVINCIA_RES', 'DISTRITO_RES', 'DNI_MO', 'FECHA_DE_NAC_MO', 'EDADMESES', '1CTRL RN as CTRLRN1', '2CTRL RN as CTRLRN2', '3CTRL RN as CTRLRN3', '4CTRL RN as CTRLRN4', '1CTRL as CTRL1', '2CTRL as CTRL2', '3CTRL as CTRL3', '4CTRL as CTRL4', '5CTRL as CTRL5', '6CTRL as CTRL6',
                    '7CTRL as CTRL7', '8CTRL as CTRL8', '9CTRL as CTRL9', '10CTRL as CTRL10', '11CTRL as CTRL11', '12CTRL as CTRL12', '14CTRL as CTRL14', '16CTRL as CTRL16', '18CTRL as CTRL18', '20CTRL as CTRL20', '22CTRL as CTRL22',
                                DB::raw("CASE WHEN EDADMESES='0' AND CUMPLECRED_RNHIS IS NOT NULL THEN 1
                                WHEN EDADMESES='1' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CUMPLECRED_RNHIS IS NOT NULL AND  [1CTRL] IS NOT NULL AND  [2CTRL] IS NOT NULL AND  [3CTRL] IS NOT NULL AND  [4CTRL] IS NOT NULL AND  [5CTRL] IS NOT NULL AND  [6CTRL] IS NOT NULL AND  [7CTRL] IS NOT NULL  AND  [8CTRL] IS NOT NULL  AND  [9CTRL] IS NOT NULL AND  [10CTRL] IS NOT NULL AND  [11CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [12CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [12CTRL] IS NOT NULL AND [14CTRL] IS NOT NULL AND [16CTRL] IS NOT NULL AND [18CTRL] IS NOT NULL AND [20CTRL] IS NOT NULL AND [22CTRL] IS NOT NULL THEN 1
                                ELSE 0
                                END 'AVANCE_HIS'"),
                                'CRN1', 'CRN2', '_CRED_1_mes', '_CRED_2_mes', '_CRED_3_mes', '_CRED_4_mes', '_CRED_5_mes', '_CRED_6_mes', '_CRED_7_mes', '_CRED_8_mes', '_CRED_9_mes', '_CRED_10_mes', '_CRED_11_mes',
                                '_CRED_12_mes', '_CRED_14_mes', '_CRED_16_mes', '_CRED_18_mes', '_CRED_20_mes', '_CRED_22_mes',
                                DB::raw("CASE WHEN EDADMESES='0' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL  THEN 1
                                WHEN EDADMESES='1' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='2' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='3' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='4' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='5' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='6' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='7' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='8' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='9' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='10' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='11' AND CRN1 IS NOT NULL AND CRN2 IS NOT NULL AND  [_CRED_1_mes] IS NOT NULL AND  [_CRED_2_mes] IS NOT NULL AND  [_CRED_3_mes] IS NOT NULL AND  [_CRED_4_mes] IS NOT NULL AND  [_CRED_5_mes] IS NOT NULL AND  [_CRED_6_mes] IS NOT NULL AND  [_CRED_7_mes] IS NOT NULL  AND  [_CRED_8_mes] IS NOT NULL  AND  [_CRED_9_mes] IS NOT NULL AND  [_CRED_10_mes] IS NOT NULL AND  [_CRED_11_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='12' AND [_CRED_12_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='14' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='16' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='18' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='20' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL THEN 1
                                WHEN EDADMESES='22' AND [_CRED_12_mes] IS NOT NULL AND [_CRED_14_mes] IS NOT NULL AND [_CRED_16_mes] IS NOT NULL AND [_CRED_18_mes] IS NOT NULL AND [_CRED_20_mes] IS NOT NULL AND [_CRED_22_mes] IS NOT NULL THEN 1
                                ELSE 0 END 'AVANCE_JUNTOS'"))
                                ->where('DISTRITO_RES', $dist) ->whereYear('FECHA_DE_NAC_MO', $anio) ->orderBy('DISTRITO_RES') ->get();
                }
            }

            return view('juntos.kids.credPaquete.printNominal', [ 'nominal' => $nominalCred, 'anio' => $anio ]);
        }
    }
}
